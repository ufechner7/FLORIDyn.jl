<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Low-Level Functions · FLORIDyn.jl</title><meta name="title" content="Low-Level Functions · FLORIDyn.jl"/><meta property="og:title" content="Low-Level Functions · FLORIDyn.jl"/><meta property="twitter:title" content="Low-Level Functions · FLORIDyn.jl"/><meta name="description" content="Documentation for FLORIDyn.jl."/><meta property="og:description" content="Documentation for FLORIDyn.jl."/><meta property="twitter:description" content="Documentation for FLORIDyn.jl."/><meta property="og:url" content="https://ufechner7.github.io/FLORIDyn.jl/dev/functions/"/><meta property="twitter:url" content="https://ufechner7.github.io/FLORIDyn.jl/dev/functions/"/><link rel="canonical" href="https://ufechner7.github.io/FLORIDyn.jl/dev/functions/"/><meta property="og:image" content="https://ufechner7.github.io/FLORIDyn.jl/dev/assets/preview.png"/><meta property="twitter:image" content="https://ufechner7.github.io/FLORIDyn.jl/dev/assets/preview.png"/><meta property="twitter:card" content="summary_large_image"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="FLORIDyn.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">FLORIDyn.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../types/">Exported Types</a></li><li class="is-active"><a class="tocitem" href>Low-Level Functions</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Calculating-the-wind-directions"><span>Calculating the wind directions</span></a></li><li class="toplevel"><a class="tocitem" href="#Calculating-the-wind-velocity"><span>Calculating the wind velocity</span></a></li><li class="toplevel"><a class="tocitem" href="#Calculating-the-wind-shear"><span>Calculating the wind shear</span></a></li><li class="toplevel"><a class="tocitem" href="#Calculating-the-wind-turbulence"><span>Calculating the wind turbulence</span></a></li><li class="toplevel"><a class="tocitem" href="#Controller-functions"><span>Controller functions</span></a></li></ul></li><li><a class="tocitem" href="../functions_II/">High-Level Functions</a></li><li><a class="tocitem" href="../settings/">Settings</a></li><li><a class="tocitem" href="../video_creation/">Video Creation</a></li><li><a class="tocitem" href="../developer/">Developer notes</a></li><li><a class="tocitem" href="../faq/">FAQ</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Low-Level Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Low-Level Functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ufechner7/FLORIDyn.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ufechner7/FLORIDyn.jl/blob/main/docs/src/functions.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Low-Level-Functions"><a class="docs-heading-anchor" href="#Low-Level-Functions">Low-Level Functions</a><a id="Low-Level-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Low-Level-Functions" title="Permalink"></a></h1><h1 id="Calculating-the-wind-directions"><a class="docs-heading-anchor" href="#Calculating-the-wind-directions">Calculating the wind directions</a><a id="Calculating-the-wind-directions-1"></a><a class="docs-heading-anchor-permalink" href="#Calculating-the-wind-directions" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FLORIDyn.getWindDirT" href="#FLORIDyn.getWindDirT"><code>FLORIDyn.getWindDirT</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getWindDirT(::Direction_Constant, wind_dir, iT, _)</code></pre><p>Return wind direction in SOWFA-degrees for the requested turbine(s).</p><p><strong>Arguments</strong></p><ul><li><code>wind_dir</code>: The wind direction (scalar).</li><li><code>iT</code>: Index or indices of the turbines (can be an integer or vector).</li><li><code>_</code>: Placeholder for unused argument.</li></ul><p><strong>Returns</strong></p><ul><li><code>phi</code>: Array of wind direction values, same size as <code>iT</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/windfield/windfield_direction.jl#L9-L21">source</a></section><section><div><pre><code class="language-julia hljs">getWindDirT(::Direction_Constant_wErrorCov, wind_dir::WindDirType, iT, t)</code></pre><p>Return wind direction in SOWFA-deg for the requested turbine(s).</p><p><strong>Arguments</strong></p><ul><li><code>wind_dir::WindDirType</code>: <a href="../types/#FLORIDyn.WindDirType">WindDirType</a></li><li><code>iT</code>: Vector of turbine indices (can be any indexable collection)</li><li><code>t</code>: Time step</li></ul><p><strong>Returns</strong></p><ul><li><code>phi</code>: Vector of wind directions for the selected turbines, including random perturbation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/windfield/windfield_direction.jl#L30-L42">source</a></section><section><div><pre><code class="language-julia hljs">getWindDirT(::Direction_Interpolation, wind_dir::AbstractMatrix, iT, t)</code></pre><p><strong>Direction_Interpolation</strong></p><p>Returns the wind direction at the respective turbine(s). Uniform interpolation version - all turbines experience the same changes.</p><p>Arguments:</p><ul><li>wind_dir::Matrix: columns are time and phi (wind direction)</li><li>iT: single value or vector with turbine index/indices</li><li>t: time of request</li></ul><p>Returns:</p><ul><li>phi: Vector of wind directions for each turbine in iT [°]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/windfield/windfield_direction.jl#L111-L126">source</a></section><section><div><pre><code class="language-julia hljs">getWindDirT(::Direction_Interpolation_wErrorCov, wind_dir::WindDirMatrix, iT, t)</code></pre><p>Returns the wind direction at the respective turbine(s). Uniform interpolation version - all turbines experience the same changes.</p><p>Arguments:</p><ul><li>wind_dir::WindDirMatrix: <a href="../types/#FLORIDyn.WindDirMatrix">WindDirMatrix</a></li><li>iT: single value or vector with turbine index/indices</li><li>t: time of request</li></ul><p>Returns:</p><ul><li>phi: Vector of wind directions for each turbine in iT [°]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/windfield/windfield_direction.jl#L148-L161">source</a></section><section><div><pre><code class="language-julia hljs">getWindDirT(::Direction_InterpTurbine, wind_dir::AbstractMatrix iT, t)</code></pre><p>Return wind direction in SOWFA-degrees for the requested turbine(s).</p><p><strong>Arguments</strong></p><ul><li><code>wind_dir::Matrix</code>: Each row is <code>[time, phi_T0, phi_T1, ...]</code>.</li><li>`iT: Index or indices of turbines.</li><li><code>t</code>: Time of request. [s]</li></ul><p><strong>Returns</strong></p><ul><li><code>phi::Vector{Float64}</code>: Wind direction(s) for the selected turbine(s) at time <code>t</code>. [°]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/windfield/windfield_direction.jl#L203-L215">source</a></section><section><div><pre><code class="language-julia hljs">getWindDirT(::Direction_InterpTurbine_wErrorCov, wind_dir::WindDirMatrix, iT, t)</code></pre><p>Return wind direction in SOWFA-deg for the requested turbine(s).</p><p><strong>Arguments</strong></p><ul><li><code>wind_dir::WindDirMatrix</code>: See: <a href="../types/#FLORIDyn.WindDirMatrix"><code>WindDirMatrix</code></a></li><li><code>iT</code>: Index or indices of the turbines (can be integer or vector)</li><li><code>t</code>: Time of request (Float64) [s]</li></ul><p><strong>Returns</strong></p><ul><li><code>phi</code>: Wind direction(s) for requested turbine(s), perturbed with noise. [°]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/windfield/windfield_direction.jl#L242-L254">source</a></section><section><div><pre><code class="language-julia hljs">getWindDirT(::Direction_RW_with_Mean, wind_dir_now, wind_dir::WindDirTriple)</code></pre><p>Returns the wind direction at the respective turbine(s).</p><p><strong>Arguments</strong></p><ul><li><code>wind_dir_now</code>: Current value (vector)</li><li><code>wind_dir::WindDirTriple</code>: <a href="../types/#FLORIDyn.WindDirTriple"><code>WindDirTriple</code></a></li></ul><p><strong>Returns</strong></p><ul><li><code>phi</code>: Updated wind direction(s) (vector) [°]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/windfield/windfield_direction.jl#L283-L294">source</a></section><section><div><pre><code class="language-julia hljs">getWindDirT(::Direction_RW_with_Mean, wind_dir::WindDirTriple, iT, t)</code></pre><p>Random walk with mean reversion model for wind direction.</p><p><strong>Arguments</strong></p><ul><li><code>::Direction_RW_with_Mean</code>: Direction mode indicator</li><li><code>wind_dir::WindDirTriple</code>: Wind direction data containing Init, CholSig, and MeanPull</li><li><code>iT</code>: Turbine index or indices</li><li><code>t</code>: Time value (unused in this implementation) [s]</li></ul><p><strong>Returns</strong></p><ul><li><code>phi</code>: Wind direction(s) for the requested turbine(s) [°]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/windfield/windfield_direction.jl#L305-L318">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FLORIDyn.getWindDirT_EnKF" href="#FLORIDyn.getWindDirT_EnKF"><code>FLORIDyn.getWindDirT_EnKF</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getWindDirT_EnKF(::Direction_EnKF_InterpTurbine, wind_dir::AbstractMatrix, iT, t)</code></pre><p><strong>Direction<em>EnKF</em>InterpTurbine</strong></p><p>Return wind direction in SOWFA-deg for the requested turbine(s).</p><p><strong>Arguments</strong></p><ul><li><code>wind_dir::Matrix</code>: Matrix where each row is [time, <code>phi_T0</code>, <code>phi_T1</code>, ... <code>phi_Tn</code>]</li><li><code>iT</code>: Index or indices of the turbines (can be integer or vector)</li><li><code>t</code>: Time of request (scalar)</li></ul><p><strong>Returns</strong></p><ul><li><code>phi</code>: Wind direction(s) at time <code>t</code> for turbine(s) <code>iT</code> [°]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/windfield/windfield_direction.jl#L73-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FLORIDyn.getDataDir" href="#FLORIDyn.getDataDir"><code>FLORIDyn.getDataDir</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getDataDir(set::Settings, wind::Wind, wf::WindFarm, t)</code></pre><p>Retrieve wind direction data for all turbines at the current simulation time.</p><p><strong>Arguments</strong></p><ul><li><code>set::Settings</code>: Simulation settings containing the direction mode configuration</li><li><code>wind::Wind</code>: Wind field data structure containing direction information and input type</li><li><code>wf::WindFarm</code>: Wind farm object containing turbine states and configuration</li><li><code>t</code>: Current simulation time for temporal interpolation</li></ul><p><strong>Returns</strong></p><ul><li><code>phi</code>: Wind direction values (typically in radians) for all turbines at the specified time</li></ul><p><strong>Description</strong></p><p>This function reads wind direction data and returns the current wind direction angle (phi) for all  turbines in the wind farm. The function handles two different input modes:</p><ol><li><p><strong>Random Walk with Mean mode</strong> (<code>wind.input_dir == &quot;RW_with_Mean&quot;</code>): Uses the current wind farm  state from <code>wf.States_WF[wf.StartI, 2]</code> along with the wind direction data to compute direction.</p></li><li><p><strong>Standard temporal interpolation mode</strong>: Uses the wind direction data directly with temporal  interpolation for all turbines at the specified simulation time.</p></li></ol><p>The function dispatches to <code>getWindDirT</code> with appropriate parameters based on the input mode,  ensuring consistent wind direction estimation across different modeling approaches.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Get wind direction for all turbines at current simulation time
phi = getDataDir(settings, wind_data, wind_farm, 100.0)

# The returned phi contains direction values for all turbines
direction_turbine_1 = phi[1]</code></pre><p><strong>Notes</strong></p><ul><li>The function automatically handles different wind input modes through conditional logic</li><li>For random walk mode, uses existing wind farm state as reference</li><li>For standard mode, performs temporal interpolation across all turbines</li></ul><p><strong>See also</strong></p><ul><li><a href="#FLORIDyn.getWindDirT"><code>getWindDirT</code></a>: Underlying function for wind direction temporal interpolation</li><li><a href="../settings/#Settings"><code>Settings</code></a>: Configuration structure containing direction mode settings</li><li><a href="../settings/#FLORIDyn.Wind"><code>Wind</code></a>: Wind field data structure containing direction information and input type</li><li><a href="../types/#FLORIDyn.WindFarm"><code>WindFarm</code></a>: Wind farm configuration structure</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/correction/direction.jl#L4-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FLORIDyn.correctDir!" href="#FLORIDyn.correctDir!"><code>FLORIDyn.correctDir!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">correctDir!(::Direction_All, set::Settings, wf::WindFarm, wind::Wind, t)</code></pre><p>Apply direction correction to all turbines in the wind farm using the Direction_All strategy.</p><p><strong>Arguments</strong></p><ul><li><code>::Direction_All</code>: The direction correction strategy type that applies corrections to all turbines</li><li><code>set::Settings</code>: Simulation settings containing the direction mode configuration</li><li><code>wf::WindFarm</code>: Wind farm object containing turbine states and configuration (modified in-place)</li><li><code>wind::Wind</code>: Wind field data structure containing direction information and input type</li><li><code>t</code>: Current simulation time for temporal interpolation</li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code>: This function modifies the wind farm state in-place and returns nothing</li></ul><p><strong>Description</strong></p><p>This function applies a direction correction using the Direction_All strategy, which updates the  wind direction for all turbines in the wind farm. The function performs the following operations:</p><ol><li><strong>Data Retrieval</strong>: Calls <code>getDataDir</code> to obtain current wind direction data for all turbines</li><li><strong>State Update</strong>: Updates the wind direction in the wind farm state (<code>wf.States_WF[:, 2]</code>)</li><li><strong>Operational Point Orientation</strong>: If the state matrix has 4 columns, also updates the  operational point orientation (<code>wf.States_WF[wf.StartI, 4]</code>) to match the wind direction</li></ol><p>The correction is applied uniformly to all turbines using the first direction value from the  retrieved direction data.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Apply direction correction to all turbines
correctDir!(Direction_All(), settings, wind_farm, wind_data, 100.0)

# The wind farm state is modified in-place
current_direction = wind_farm.States_WF[1, 2]  # Updated direction for first turbine</code></pre><p><strong>Notes</strong></p><ul><li>This function modifies the wind farm state in-place (indicated by the <code>!</code> suffix)</li><li>All turbines receive the same direction correction value (<code>phi[1]</code>)</li><li>The operational point orientation is only updated if the state matrix has 4 columns</li><li>Direction values are typically in radians following standard wind engineering conventions</li></ul><p><strong>See also</strong></p><ul><li><a href="#FLORIDyn.getDataDir"><code>getDataDir</code></a>: Function for retrieving wind direction data</li><li><a href="../types/#FLORIDyn.Direction_All"><code>Direction_All</code></a>: Direction correction strategy type</li><li><a href="../settings/#Settings"><code>Settings</code></a>: Simulation settings structure</li><li><a href="../types/#FLORIDyn.WindFarm"><code>WindFarm</code></a>: Wind farm configuration structure</li><li><a href="../settings/#FLORIDyn.Wind"><code>Wind</code></a>: Wind field data structure</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/correction/direction.jl#L63-L111">source</a></section></article><h1 id="Calculating-the-wind-velocity"><a class="docs-heading-anchor" href="#Calculating-the-wind-velocity">Calculating the wind velocity</a><a id="Calculating-the-wind-velocity-1"></a><a class="docs-heading-anchor-permalink" href="#Calculating-the-wind-velocity" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FLORIDyn.getDataVel" href="#FLORIDyn.getDataVel"><code>FLORIDyn.getDataVel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getDataVel(set::Settings, wind::Wind, wf::WindFarm, t, tmp_m, floris::Floris)</code></pre><p>Retrieve wind velocity data for all turbines at the current simulation time using various input modes.</p><p><strong>Arguments</strong></p><ul><li><code>set::Settings</code>: Simulation settings containing the velocity mode configuration</li><li><code>wind::Wind</code>: Wind field data structure containing velocity information and input type</li><li><code>wf::WindFarm</code>: Wind farm object containing turbine states and configuration</li><li><code>t</code>: Current simulation time for temporal interpolation</li><li><code>tmp_m</code>: Temporary matrix containing reduction factors and other intermediate calculations</li><li><code>floris::Floris</code>: FLORIS model parameters including wake model coefficients</li></ul><p><strong>Returns</strong></p><ul><li><code>u</code>: Wind velocity values for all turbines at the specified time</li><li><code>wind::Wind</code>: Updated wind field data structure (may be modified for certain input modes)</li></ul><p><strong>Description</strong></p><p>This function reads wind velocity data and returns the current wind speed (U) for all turbines  in the wind farm. The function handles multiple input modes through conditional logic:</p><ol><li><p><strong>Interpolation and Integration mode</strong> (<code>&quot;I_and_I&quot;</code>): Uses <code>getWindSpeedT</code> with turbine positions,  wind direction, and FLORIS parameters. Applies wake effects reduction if the simulation time  exceeds the wind speed estimator offset.</p></li><li><p><strong>Random Walk with Mean mode</strong> (<code>&quot;RW_with_Mean&quot;</code>): Uses the current wind farm state from  <code>wf.States_WF[wf.StartI, 1]</code> with the wind velocity model.</p></li><li><p><strong>Ensemble Kalman Filter mode</strong> (<code>&quot;EnKF_InterpTurbine&quot;</code>): Uses EnKF-based interpolation  at turbine locations via <code>getWindSpeedT_EnKF</code>.</p></li><li><p><strong>Standard temporal interpolation mode</strong> (default): Uses direct temporal interpolation  with <code>getWindSpeedT</code> for all turbines.</p></li></ol><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Get wind velocity for all turbines at current simulation time
u, updated_wind = getDataVel(settings, wind_data, wind_farm, 100.0, temp_matrix, floris_params)

# The returned u contains velocity values for all turbines
velocity_turbine_1 = u[1]</code></pre><p><strong>Notes</strong></p><ul><li>The function automatically handles different wind input modes through conditional logic</li><li>For I<em>and</em>I mode, wake effects are applied based on timing and reduction factors</li><li>The wind structure may be modified and returned for certain input modes</li><li>Velocity values are in m/s</li><li>Wake reduction is only applied in I<em>and</em>I mode when sufficient time has elapsed</li></ul><p><strong>See also</strong></p><ul><li><a href="../settings/#Settings"><code>Settings</code></a>: Simulation settings structure</li><li><a href="../settings/#FLORIDyn.Wind"><code>Wind</code></a>: Wind field data structure</li><li><a href="../types/#FLORIDyn.WindFarm"><code>WindFarm</code></a>: Wind farm configuration structure</li><li><a href="../settings/#FLORIDyn.Floris"><code>Floris</code></a>: FLORIS model parameters structure</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/correction/velocity.jl#L14-L69">source</a></section></article><h1 id="Calculating-the-wind-shear"><a class="docs-heading-anchor" href="#Calculating-the-wind-shear">Calculating the wind shear</a><a id="Calculating-the-wind-shear-1"></a><a class="docs-heading-anchor-permalink" href="#Calculating-the-wind-shear" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FLORIDyn.getWindShearT" href="#FLORIDyn.getWindShearT"><code>FLORIDyn.getWindShearT</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getWindShearT(::Shear_Interpolation, WindShear::AbstractMatrix, z)</code></pre><p>Compute the wind shear at a given height <code>z</code> using the specified <code>WindShear</code> model.</p><p><strong>Arguments</strong></p><ul><li><code>::Shear_Interpolation</code>: (Type only) Use interpolation to determine the wind shear.</li><li><code>WindShear</code>: A matrix describing the wind shear profile.</li><li><code>z</code>: The height (in meters) at which to evaluate the wind shear.</li></ul><p><strong>Returns</strong></p><ul><li>The wind shear value at height <code>z</code>.</li></ul><p><strong>REMARKS</strong></p><p>Expects a .csv file called &quot;WindShearProfile.csv&quot; with a normalized wind speed profile for different heights:</p><pre><code class="nohighlight hljs">z, (u_z/u0)
z, (u_z/u0)
z, (u_z/u0)</code></pre><p>There is a linear interpolation between every pair. In case z is out of bounds the function will use the closest available setpoint.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/windfield/windfield_shear.jl#L6-L28">source</a></section><section><div><pre><code class="language-julia hljs">getWindShearT(::Shear_PowerLaw, WindShear, z_norm)</code></pre><p>Return the shear factor <code>u_eff = shear * u_referenceHeight</code> using the power law.</p><p><strong>Arguments</strong></p><ul><li><code>Shear_PowerLaw</code>: (type only, unused) Specifies that this method applies to the power law model</li><li><code>WindShear</code>: A struct of type (<code>WindShear</code>)(@ref)<ul><li><code>z0</code>: Reference height (not used in this function)</li><li><code>alpha</code>: WindShear coefficient</li></ul></li><li><code>z_norm</code>: Height(s) (can be scalar or array)</li></ul><p><strong>Returns</strong></p><ul><li><code>shear</code>: The shear factor at the given height(s)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/windfield/windfield_shear.jl#L58-L72">source</a></section></article><h1 id="Calculating-the-wind-turbulence"><a class="docs-heading-anchor" href="#Calculating-the-wind-turbulence">Calculating the wind turbulence</a><a id="Calculating-the-wind-turbulence-1"></a><a class="docs-heading-anchor-permalink" href="#Calculating-the-wind-turbulence" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FLORIDyn.getDataTI" href="#FLORIDyn.getDataTI"><code>FLORIDyn.getDataTI</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getDataTI(set::Settings, wind::Wind, wf::WindFarm, t) -&gt; Vector</code></pre><p>Retrieve turbulence intensity data for all turbines at the current simulation time.</p><p>This function obtains turbulence intensity values for all turbines in the wind farm using the configured turbulence model and wind field data. It serves as a wrapper around the underlying turbulence intensity retrieval system.</p><p><strong>Arguments</strong></p><ul><li><code>set::Settings</code>: Settings object containing simulation configuration<ul><li><code>set.turb_mode</code>: Turbulence model configuration specifying the retrieval method</li></ul></li><li><code>wind::Wind</code>: Wind configuration object containing turbulence intensity data<ul><li><code>wind.ti</code>: Turbulence intensity data, parameters, or model configuration</li></ul></li><li><code>wf::WindFarm</code>: Wind farm object containing turbine information<ul><li><code>wf.nT</code>: Number of turbines in the wind farm</li></ul></li><li><code>t</code>: Current simulation time for time-dependent turbulence intensity models</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector</code>: Turbulence intensity values for all turbines (dimensionless, typically 0.05-0.25)</li></ul><p><strong>Behavior</strong></p><p>The function creates a vector of all turbine indices <code>[1, 2, ..., nT]</code> and retrieves the corresponding turbulence intensity values using the specified turbulence model. The actual retrieval method depends on the <code>set.turb_mode</code> configuration and can include:</p><ul><li>Constant turbulence intensity</li><li>Time-interpolated values from data files</li><li>Turbine-specific interpolation</li><li>Random walk models with covariance</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Get turbulence intensity for all turbines at t=100s
TI_values = getDataTI(settings, wind_config, wind_farm, 100.0)
println(&quot;TI for turbine 1: &quot;, TI_values[1])</code></pre><p><strong>See Also</strong></p><ul><li><a href="#FLORIDyn.getWindTiT"><code>getWindTiT</code></a>: Underlying function for turbulence intensity retrieval</li><li><a href="#FLORIDyn.correctTI!"><code>correctTI!</code></a>: Function that uses this data to update wind farm states</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/correction/turbulence.jl#L71-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FLORIDyn.getWindTiT" href="#FLORIDyn.getWindTiT"><code>FLORIDyn.getWindTiT</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getWindTiT(::TI_Constant, wind_ti::Number, iT, _)</code></pre><p>Return turbulence intensity for the requested turbine(s).</p><p><strong>Arguments</strong></p><ul><li><code>::TI_Constant</code>: type parameter to indicate constant wind turbulence</li><li><code>wind_ti::Number</code>: Constant value (turbulence intensity)</li><li><code>iT</code>: Index or indices of the turbines</li><li><code>_</code>: will be ignored</li></ul><p><strong>Returns</strong></p><ul><li><code>Ti</code>: Array of turbulence intensity values for each turbine index</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/windfield/windfield_turbulence.jl#L4-L17">source</a></section><section><div><pre><code class="language-julia hljs">getWindTiT(::TI_Interpolation, wind_ti::AbstractMatrix, iT, t)</code></pre><p>Interpolates the wind turbulence intensity (TI) at a given time <code>t</code> using the specified <code>TI_Interpolation</code> method.</p><p><strong>Arguments</strong></p><ul><li><code>::TI_Interpolation</code>: Use linear interpolation to calculate the turbulence intensity.</li><li><code>wind_ti::Matrix</code>: Matrix containing wind turbulence intensity values over time.</li><li><code>iT</code>: Index/indices of the turbines (can be Int or array).</li><li><code>t</code>: The specific time at which to interpolate the turbulence intensity.</li></ul><p><strong>Returns</strong></p><ul><li>The interpolated turbulence for the requested turbine(s) at time <code>t</code>.</li></ul><p><strong>Notes</strong></p><ul><li>The function assumes that <code>wind_ti</code> contains the necessary data for interpolation as (time, TI) pairs (n×2 matrix)</li><li>Uniform interpolation version - all turbines experience the same changes.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/windfield/windfield_turbulence.jl#L54-L72">source</a></section><section><div><pre><code class="language-julia hljs">getWindTiT(::TI_InterpTurbine, wind_ti::AbstractMatrix, iT, t)</code></pre><p>Retrieve the wind turbulence intensity (TI) for a specific turbine at a given time.</p><p><strong>Arguments</strong></p><ul><li><code>::TI_InterpTurbine</code>: The turbulence intensity interpolation object for the turbine.</li><li><code>wind_ti::AbstractMatrix</code>: Matrix containing wind turbulence intensity values.</li><li><code>iT</code>: Index of the turbine for which the TI is requested.</li><li><code>t</code>: Time at which the TI value is needed.</li></ul><p><strong>Returns</strong></p><ul><li>The interpolated wind turbulence intensity value for the specified turbine at time <code>t</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/windfield/windfield_turbulence.jl#L139-L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FLORIDyn.correctTI!" href="#FLORIDyn.correctTI!"><code>FLORIDyn.correctTI!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">correctTI!(::TI_None, set::Settings, wf::WindFarm, wind::Wind, t) -&gt; Nothing</code></pre><p>Update turbulence intensity values in the wind farm state matrix without correction.</p><p>This function implements the &quot;no correction&quot; strategy for turbulence intensity, where  the wind farm turbulence intensity values are updated with fresh data from the wind  field model without applying any correction algorithms. It serves as the baseline  approach for turbulence intensity handling in FLORIDyn simulations.</p><p><strong>Arguments</strong></p><ul><li><code>::TI_None</code>: Dispatch type indicating no turbulence intensity correction algorithm</li><li><code>set::Settings</code>: Settings object containing simulation configuration and turbulence model parameters<ul><li><code>set.turb_mode</code>: Turbulence model configuration specifying the retrieval method</li></ul></li><li><code>wf::WindFarm</code>: Wind farm object containing the state matrices to be updated<ul><li><code>wf.States_WF</code>: Wind field states matrix where column 3 contains turbulence intensity values</li><li><code>wf.StartI</code>: Starting indices for each turbine&#39;s operational points</li><li><code>wf.nT</code>: Number of turbines</li></ul></li><li><code>wind::Wind</code>: Wind configuration object containing turbulence intensity data<ul><li><code>wind.ti</code>: Turbulence intensity data or model parameters</li></ul></li><li><code>t</code>: Current simulation time for time-dependent turbulence intensity retrieval</li></ul><p><strong>Returns</strong></p><ul><li><code>Nothing</code>: The function modifies the wind farm state in-place</li></ul><p><strong>Behavior</strong></p><ol><li>Retrieves current turbulence intensity values for all turbines using <a href="#FLORIDyn.getDataTI"><code>getDataTI</code></a></li><li>Updates the wind farm state matrix <code>wf.States_WF</code> at rows <code>wf.StartI</code> and column 3</li><li>Transposes the turbulence intensity vector to match the matrix structure</li><li>Provides error handling for matrix update operations</li></ol><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Update turbulence intensity without correction at t=50s
correctTI!(TI_None(), settings, wf, wind, 50.0)

# The wind farm state matrix is now updated with new TI values
current_ti = wf.States_WF[wf.StartI, 3]</code></pre><p><strong>Notes</strong></p><ul><li>The function modifies the wind farm object in-place (indicated by the <code>!</code> suffix)</li><li>This &quot;no correction&quot; approach provides baseline turbulence intensity without  applying wake-induced corrections or measurement-based adjustments</li><li>Error handling ensures graceful failure if matrix dimensions are incompatible</li></ul><p><strong>See Also</strong></p><ul><li><a href="#FLORIDyn.getDataTI"><code>getDataTI</code></a>: Function used to retrieve turbulence intensity data</li><li><a href="../types/#FLORIDyn.TI_None"><code>TI_None</code></a>: Dispatch type for no correction strategy</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/correction/turbulence.jl#L4-L53">source</a></section></article><h1 id="Controller-functions"><a class="docs-heading-anchor" href="#Controller-functions">Controller functions</a><a id="Controller-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Controller-functions" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FLORIDyn.getYaw" href="#FLORIDyn.getYaw"><code>FLORIDyn.getYaw</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getYaw(::Yaw_SOWFA, ConYawData::AbstractMatrix, iT, t) -&gt; Float64 or Vector{Float64}</code></pre><p>Return the yaw angle at time <code>t</code> for the specified turbine(s) using linear interpolation.</p><p><strong>Arguments</strong></p><ul><li><code>::Yaw_SOWFA</code>: Controller type dispatch parameter for SOWFA-style yaw control</li><li><code>ConYawData::Matrix{Float64}</code>: Control data matrix where:<ul><li>First column contains time values (in seconds)</li><li>Subsequent columns contain yaw angles for each turbine (in degrees)</li></ul></li><li><code>iT</code>: Turbine index or indices to query:<ul><li><code>Integer</code>: Single turbine index (1-based)</li><li><code>AbstractVector{&lt;:Integer}</code>: Vector of turbine indices for multiple turbines</li></ul></li><li><code>t::Real</code>: Requested time (in seconds)</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: Single yaw angle (in degrees) if <code>iT</code> is an integer</li><li><code>Vector{Float64}</code>: Vector of yaw angles (in degrees) if <code>iT</code> is a vector</li></ul><p><strong>Behavior</strong></p><ul><li><strong>Interpolation</strong>: Uses linear interpolation between time points with flat extrapolation</li><li><strong>Out-of-bounds handling</strong>: If <code>t</code> is outside the time range, the function:<ul><li>Issues a warning message</li><li>Clamps <code>t</code> to the nearest boundary (first or last time point)</li></ul></li><li><strong>Single time point</strong>: If only one time point exists, returns the corresponding yaw value directly</li><li><strong>Error handling</strong>: Throws an error if <code>iT</code> is not an integer or vector of integers</li></ul><p><strong>Data Format</strong></p><p>The <code>con_yaw_data</code> matrix should have the structure:</p><pre><code class="nohighlight hljs">[time₁  yaw₁₁  yaw₁₂  ...  yaw₁ₙ]
[time₂  yaw₂₁  yaw₂₂  ...  yaw₂ₙ]
[  ⋮      ⋮      ⋮    ⋱     ⋮  ]
[timeₘ  yawₘ₁  yawₘ₂  ...  yawₘₙ]</code></pre><p>where <code>m</code> is the number of time steps and <code>n</code> is the number of turbines.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Example control data: 3 time points, 2 turbines
con_yaw_data = [0.0  10.0  5.0;   # t=0s: T1=10°, T2=5°
                1.0  15.0  10.0;  # t=1s: T1=15°, T2=10°
                2.0  20.0  15.0]  # t=2s: T1=20°, T2=15°

# Get yaw for turbine 1 at t=0.5s (interpolated)
yaw1 = getYaw(Yaw_SOWFA(), con_yaw_data, 1, 0.5)  # Returns 12.5°

# Get yaw for multiple turbines at t=1.5s
yaws = getYaw(Yaw_SOWFA(), con_yaw_data, [1, 2], 1.5)  # Returns [17.5°, 12.5°]

# Out-of-bounds time (will issue warning)
yaw_oob = getYaw(Yaw_SOWFA(), con_yaw_data, 1, 5.0)  # Returns 20.0° with warning</code></pre><p><strong>See Also</strong></p><ul><li><a href="../types/#FLORIDyn.Yaw_SOWFA"><code>Yaw_SOWFA</code></a>: Controller type for SOWFA-style yaw control</li><li><code>Interpolations.linear_interpolation</code>: Underlying interpolation method used</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ufechner7/FLORIDyn.jl/blob/1bee007193ced9d3e0ea874a1979ad853d17dccc/src/controller/controller.jl#L4-L61">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../types/">« Exported Types</a><a class="docs-footer-nextpage" href="../functions_II/">High-Level Functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 4 August 2025 13:00">Monday 4 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
