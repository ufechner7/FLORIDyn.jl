<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Optimization of the turbine induction factors of a wind farm for time-shifting the power output · FLORIDyn.jl</title><meta name="title" content="Optimization of the turbine induction factors of a wind farm for time-shifting the power output · FLORIDyn.jl"/><meta property="og:title" content="Optimization of the turbine induction factors of a wind farm for time-shifting the power output · FLORIDyn.jl"/><meta property="twitter:title" content="Optimization of the turbine induction factors of a wind farm for time-shifting the power output · FLORIDyn.jl"/><meta name="description" content="Documentation for FLORIDyn.jl."/><meta property="og:description" content="Documentation for FLORIDyn.jl."/><meta property="twitter:description" content="Documentation for FLORIDyn.jl."/><meta property="og:url" content="https://ufechner7.github.io/FLORIDyn.jl/dev/optimize_inductions/"/><meta property="twitter:url" content="https://ufechner7.github.io/FLORIDyn.jl/dev/optimize_inductions/"/><link rel="canonical" href="https://ufechner7.github.io/FLORIDyn.jl/dev/optimize_inductions/"/><meta property="og:image" content="https://ufechner7.github.io/FLORIDyn.jl/dev/assets/preview.png"/><meta property="twitter:image" content="https://ufechner7.github.io/FLORIDyn.jl/dev/assets/preview.png"/><meta property="twitter:card" content="summary_large_image"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="FLORIDyn.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">FLORIDyn.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../types/">Exported Types</a></li><li><a class="tocitem" href="../functions/">Low-Level Functions</a></li><li><a class="tocitem" href="../functions_II/">High-Level Functions</a></li><li><a class="tocitem" href="../settings/">Settings</a></li><li><a class="tocitem" href="../video_creation/">Video Creation</a></li><li><a class="tocitem" href="../user_guide/">User Guide</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../developer/">Developer notes</a></li><li><a class="tocitem" href="../faq/">FAQ</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Optimization of the turbine induction factors of a wind farm for time-shifting the power output</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Optimization of the turbine induction factors of a wind farm for time-shifting the power output</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ufechner7/FLORIDyn.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ufechner7/FLORIDyn.jl/blob/main/docs/src/optimize_inductions.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Optimization-of-the-turbine-induction-factors-of-a-wind-farm-for-time-shifting-the-power-output"><a class="docs-heading-anchor" href="#Optimization-of-the-turbine-induction-factors-of-a-wind-farm-for-time-shifting-the-power-output">Optimization of the turbine induction factors of a wind farm for time-shifting the power output</a><a id="Optimization-of-the-turbine-induction-factors-of-a-wind-farm-for-time-shifting-the-power-output-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-of-the-turbine-induction-factors-of-a-wind-farm-for-time-shifting-the-power-output" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>In the literature you can find some research results on dynamic induction factor control with the goal to reduce wake effects and to increase the power output [@Frederik2020], [@Munters2018]. But the question if and how much the power of a wind farm or of a wind farm cluster can be shifted in time by using dynamic induction control has not yet been investigated. Here, we try to find an answer to this question.</p><h2 id="Test-case"><a class="docs-heading-anchor" href="#Test-case">Test case</a><a id="Test-case-1"></a><a class="docs-heading-anchor-permalink" href="#Test-case" title="Permalink"></a></h2><p>As test case the NordseeOne wind farm at a free flow wind speed of <span>$8.2 m/s$</span> and a turbulence intensity of 6.2 % at turbine height was used. A constant wind direction, directly from the west is assumed.</p><p>The wind farm layout, using six turbine groups is shown in Fig. \ref{fig:windfarm_6T}:</p><p><img src="../windfarm_6T.png" alt="Wind farm NordseeOne\\label{fig:windfarm_6T}"/>{width=100%}</p><p>The goal of the optimization is, that the production matches the demand as close as possible. In this test case we assume a constant demand of 40% of the power at free-flow wind speed at the beginning, that starts to rise at 1740s simulation time, rises to 80% at 2460s and then stays constant again (see Fig. \ref{fig:power-demand-1t}).</p><h2 id="Collective-turbine-control"><a class="docs-heading-anchor" href="#Collective-turbine-control">Collective turbine control</a><a id="Collective-turbine-control-1"></a><a class="docs-heading-anchor-permalink" href="#Collective-turbine-control" title="Permalink"></a></h2><p>The most simple way to match production and demand is to control the induction factor of the turbines of the wind farm cluster, assuming all use the same induction factor.</p><p>We assume \begin{equation} \label{eq:cp-max} C_{\text{p,max}} = \frac{16}{27} \end{equation}</p><p>Furthermore, we assume that the relative demand (relative to the power at free-flow velocity) is given as \begin{equation} \label{eq:demand-rel} p<em>{\text{d,rel}} = d(t) \end{equation} At the beginning, the demand is 40%. At t=t</em>\text{start}$ the demand starts to rise, and at <span>$t=t_\text{end}$</span> it reaches  80% and then stays constant. In the first test case we use <span>$t_\text{start}=1740s$</span> and <span>$t_\text{end}=2460s$</span>. The resulting demand profile is shown in Fig. \ref{fig:power-demand-1t}. </p><p>The power coefficient of an ideal wind turbine is related to the induction factor following \begin{equation} \label{eq:cp-induction} C<em>{\text{p}} = 4a(1-a)^2 \end{equation} The inverse relationship a(C</em>{\text{p}})$ is obtained by numerically solving this equation for <span>$a \in [0, 1/3]$</span>.</p><p>By combining Eqs. \eqref{eq:cp-max}, \eqref{eq:demand-rel} and \eqref{eq:cp-induction}, and applying <span>$C_{\text{p}} = d(t) \cdot C_{\text{p,max}}$</span> we can  determine the set value of the induction factor of the turbines as \begin{equation} \label{eq:induction-time} a = f(d(t)) \end{equation}</p><p>This would be correct without wakes. Because of the wake effects, we need to increase the set-power of the turbines with a correction factor. This - time dependent - correction factor is defined as a cubic Hermite spline [@Fageot2020], based on <span>$n$</span> control points. The first control point defines the correction  for <span>$t &lt;= t_\text{start}$</span>, the last control point defines the correction for <span>$t &gt;= t_\text{end}$</span>, and the additional  control points are distributed evenly between the first and the last point. In mathematical notation:</p><p>\begin{equation} \label{eq:correction-func} c(t) = \begin{cases} c<em>1 &amp; \text{if } t \leq t</em>{\text{start}} \
H<em>i(s) &amp; \text{if } t</em>{\text{start}} &lt; t &lt; t<em>{\text{end}} \
c</em>n &amp; \text{if } t \geq t_{\text{end}} \end{cases} \end{equation}</p><p>where <span>$s = \frac{t - t_{\text{start}}}{t_{\text{end}} - t_{\text{start}}}$</span> is the normalized time parameter <span>$s \in [0, 1]$</span>, and <span>$H_i(s)$</span> is the cubic Hermite interpolation between control points <span>$c_i$</span> at positions <span>$s_i = \frac{i-1}{n-1}$</span> for <span>$i = 1, \ldots, n$</span>.</p><p>For each segment between control points, the Hermite spline is given by: \begin{equation} \label{eq:hermite-spline} H<em>i(s) = h</em>{00}(u) \cdot c<em>i + h</em>{10}(u) \cdot m<em>i \cdot \Delta s + h</em>{01}(u) \cdot c<em>{i+1} + h</em>{11}(u) \cdot m_{i+1} \cdot \Delta s \end{equation}</p><p>where <span>$u = \frac{s - s_i}{\Delta s}$</span> with <span>$\Delta s = \frac{1}{n-1}$</span>, and the Hermite basis functions are: \begin{align} h<em>{00}(u) &amp;= 2u^3 - 3u^2 + 1 \
h</em>{10}(u) &amp;= u^3 - 2u^2 + u \
h<em>{01}(u) &amp;= -2u^3 + 3u^2 \
h</em>{11}(u) &amp;= u^3 - u^2 \end{align}</p><p>The tangents <span>$m_i$</span> at each control point are computed using central differences: \begin{equation} \label{eq:tangents} m<em>i = \begin{cases} \frac{c</em>2 - c<em>1}{\Delta s} &amp; \text{if } i = 1 \
\frac{c</em>{i+1} - c<em>{i-1}}{2\Delta s} &amp; \text{if } 1 &lt; i &lt; n \
\frac{c</em>n - c_{n-1}}{\Delta s} &amp; \text{if } i = n \end{cases} \end{equation}</p><p>To obtain the vector of the control points \begin{equation} \label{eq:control<em>points} \mathbf{c} = (c</em>1, \ldots, c_n) \end{equation}</p><p>we solve the following optimization problem using the NOMAD [@montoison-pascal-salomon-nomad-2020] optimizer: \begin{equation} \label{eq:optimization} \min<em>{\mathbf{c}} \sum</em>{t=t<em>{\text{start}}}^{t</em>{\text{end}}+t<em>{\text{extra}}} \left(p(t) - d(t) \right)^2 \end{equation} where <span>$p(t)$</span> is the relative wind park power output at time <span>$t$</span>, t</em>{\text{start}}$ is the time when the demand starts to increase, <span>$t_{\text{end}}$</span> the time when it reaches its maximum and <span>$t_{\text{extra}}$</span> the time the wind field needs to reach its equilibrium.</p><p>Fig. \ref{fig:correction-factor} shows optimal correction factors as a function of the normalized parameter <span>$s$</span> as determined by the optimizer. The curve is rising when the demand is rising. This makes sense, because a higher demand causes higher induction factors, which cause more wake losses that need to be compensated.</p><p><img src="../Scaling_Curve.png" alt="Correction factor for the set value of the power of the turbines\\label{fig:correction-factor}"/>{width=70%}</p><p>If we combine Eq. \ref{eq:induction-time} and Eq. \ref{eq:correction-func}, we get \begin{equation} \label{eq:induction-time-corrected} a = f(c(t) * d(t)) \end{equation}</p><p>Using this equation, we can calculate the vector of the induction factors \begin{equation} \mathbf{a} = (a<em>1, \ldots, a</em>m) \end{equation} for each time step of the simulation. Fig. \ref{fig:induction-factor} shows optimal induction factors as a function of time as calculated by the optimizer.</p><p><img src="../Induction_by_Group.png" alt="Induction factor, collective turbine control\\label{fig:induction-factor}"/>{width=70%}</p><p>Using these induction factors as input, the result of the FLORIDyn [@becker2022floridyn] simulation is the vector \begin{equation} \mathbf{p} = (p<em>1, \ldots, p</em>m) \end{equation} of the relative wind park power (relative to the power without wakes at free-flow wind speed).</p><p>Fig. \ref{fig:power-demand-1t} shows the resulting relative wind park power and relative demand as a function of time:</p><p><img src="../Rel_Power_and_Demand_1T.png" alt="Relative Power and Demand\\label{fig:power-demand-1t}"/>{width=70%}</p><p>The Root Mean Square Error (RMSE) between demand and production is 3.86%. </p><h2 id="Turbine-group-(TG)-control"><a class="docs-heading-anchor" href="#Turbine-group-(TG)-control">Turbine group (TG) control</a><a id="Turbine-group-(TG)-control-1"></a><a class="docs-heading-anchor-permalink" href="#Turbine-group-(TG)-control" title="Permalink"></a></h2><p>To improve the tracking between production and demand, the turbines are now divided in (approximately) equal sized groups. The grouping is done depending on the coordinate of each turbine in the mean wind direction, such that the most upwind group of turbines has number one. </p><p>The axial induction factor <span>$a$</span> of each turbine group shall be controlled to achieve the best match between power demand and power production. To achieve this goal, in addition to the vector <span>$\mathbf{c}$</span> as defined in Eq. \ref{eq:control<em>points} we need a second vector that controls the power distribution of the turbine groups. We define the vector <span>$\mathbf{e}$</span> with <span>$u$</span> elements as \begin{equation} \mathbf{e} = (e</em>1, \ldots, e<em>\text{u}), \quad 1 \leq e</em>i \leq 3 \end{equation} with <span>$u$</span> being the number of turbine groups and \begin{equation} e<em>\text{u} = \frac{3}{2} u - \sum</em>{i=1}^{u-1} e<em>i \end{equation} With this definition we achieve the goal that the mean of the elements of <span>$\mathbf{e}$</span> is <span>$1.5$</span> and thus constant. Changing e</em>1 .. e<em>{u-1}$ shall only modify the distribution of the power between the turbine groups, but not the total free-stream power. The variables e</em>1 .. e_{u-1}$ are the additional free variables that need to be optimized.</p><p>The optimization problem (Eq. \ref{eq:optimization}) needs to be extended to include the vector e and now looks like: \begin{equation} \label{eq:optimization<em>tg} \min</em>{\mathbf{c,~e}} \sum<em>{t=t</em>{\text{start}}}^{t<em>{\text{end}}+t</em>{\text{extra}}} \left(p(t) - d(t) \right)^2 \end{equation} .</p><p>Eq. \ref{eq:induction-time-corrected} must be extended, too. We do this in two steps: First, we calculate the power that a turbine group shall contribute to the total power. We do that such that for <span>$e_\text{i}=0$</span> the turbine group works at full power all the time, for <span>$e_\text{i}=1$</span> it contributes exactly the free-stream power that would mach the demand, for higher values of <span>$e_\text{i}$</span> it contributes less, and for values above two the contribution at the beginning is zero and the turbine starts to operate later. We do this because we know that at the end of the rise of the demand all available power is needed, and at the beginning some of the turbine groups should produce nothing or less than their full share. \begin{equation} p<em>\text{set,i} = c(t) \big(p</em>\text{max} - e<em>\text{i} (p</em>\text{max} - d(t))\big) \end{equation} We use the same, time dependent correction function <span>$c(t)$</span> for all turbine groups, but the required relative power per turbine group is corrected using the formula given above.</p><p>The correction function based on the optimized values of <span>$\mathbf{c}$</span> is shown in Fig. \ref{fig:correction-6t}:</p><p><img src="../Scaling_Curve_6T.png" alt="Correction function for six turbine groups.\\label{fig:correction-6t}"/>{width=70%}</p><p>This value is than limited to the valid range between zero and one and finally used to calculate the required induction factor. Using the helper function \begin{equation} \text{clamp}(x,a,b) = \min(\max(x,a),b) \end{equation} we define:</p><p>\begin{equation} \label{eq:induction<em>tg} \mathbf{a}</em>\text{i} = f(\text{clamp}(p_\text{set,i}, 0, 1)) \end{equation}</p><p>In Fig. \ref{fig:induction-by-group-6t}, the resulting time series of the induction factors per turbine group are shown:</p><p><img src="../Induction_by_Group_6T.png" alt="Induction by turbine group; the blue line is behind the green line.\\label{fig:induction-by-group-6t}"/>{width=70%}</p><p>Using this matrix of induction factors as input, the result of the FLORIDyn [@becker2022floridyn] simulation is the vector \begin{equation} \mathbf{p} = (p<em>1, \ldots, p</em>m) \end{equation} of the relative wind park power (relative to the power without wakes at free-flow wind speed).</p><p>Fig. \ref{fig:power-demand-6TG} shows the resulting relative wind park power and relative demand as a function of time:</p><p><img src="../Rel_Power_and_Demand_6T.png" alt="Relative Power and Demand, optimized result for six turbine groups\\label{fig:power-demand-6TG}"/>{width=70%}</p><p>The Root Mean Square Error (RMSE) between demand and production is 2.61% (down from 3.86% without turbine group control).  The estimated storage time at 100% power is 23.08s. This means, for about 10 minutes more than 2% additional power is available, compared to collective turbine control. This energy was stored as kinetic energy in the wind field.</p><h2 id="Optimization-software"><a class="docs-heading-anchor" href="#Optimization-software">Optimization software</a><a id="Optimization-software-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-software" title="Permalink"></a></h2><p>The model and the optimization software used are available under an open source license at [@fechner<em>2025</em>17287772]. Use the command <code>include(&quot;examples/mpc.jl&quot;)</code> at the Julia prompt to reproduce the results, presented here.</p><p>The optimization for collective turbine control required about 500 simulations, the optimization with six turbine groups about 1400 simulations to converge, where one simulation needs about 3s on a Laptop with an Ryzen 7840U CPU.</p><h2 id="Conclusions-and-outlook"><a class="docs-heading-anchor" href="#Conclusions-and-outlook">Conclusions and outlook</a><a id="Conclusions-and-outlook-1"></a><a class="docs-heading-anchor-permalink" href="#Conclusions-and-outlook" title="Permalink"></a></h2><p>The simulations indicate that a slight increase in power when it is needed most is possible, for example 2% more for 10 minutes for a single wind farm. Perhaps larger values can be achieved when controlling a wind farm cluster. Next steps are:</p><ul><li>use a second test case with a time varying wind speed (impulse shaped)</li><li>simulate a wind farm cluster</li><li>investigate the sensitivity of the result regarding wind speed and wind direction</li><li>further verify the simulation model using LES simulation</li></ul><h1 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h1></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 26 November 2025 17:17">Wednesday 26 November 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
