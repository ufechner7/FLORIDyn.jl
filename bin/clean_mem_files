#!/bin/bash
# Copyright (c) 2025 Marcus Becker, Uwe Fechner
# SPDX-License-Identifier: BSD-3-Clause

# Clean up memory allocation tracking files (.mem files)
# These files are generated by Julia's --track-allocation flag

echo "Cleaning up .mem files..."

# Count .mem files before deletion
mem_count=$(find . -name "*.mem" -type f | wc -l)

if [ "$mem_count" -eq 0 ]; then
    echo "No .mem files found."
    exit 0
fi

echo "Found $mem_count .mem files"

# Delete all .mem files recursively
find . -name "*.mem" -type f -delete

# Verify deletion
remaining_count=$(find . -name "*.mem" -type f | wc -l)

if [ "$remaining_count" -eq 0 ]; then
    echo "Successfully deleted $mem_count .mem files."
else
    echo "Warning: $remaining_count .mem files still remain."
    exit 1
fi
